---
title: "Poisson Tinkering"
author: "Stuart Lacy"
date: "29 April 2016"
output: 
  html_document: 
    number_sections: yes
    theme: lumen
    toc: yes
    toc_float:
        collapsed: false
    code_folding: show
---

Just a file to play with the poisson distribution to help improve my understanding of it.

# `dpois`

The density (well mass function really as it's a discrete distribution) gives the probability of having `x` events in a set timeframe which has a rate of `lambda` in that timeframe.

Say I have 20 incident cases a year on average, I can calculate the probability of different numbers of events:

```{r}
dvals <- sapply(1:30, dpois, lambda=20)
plot(dvals)
```

As expected, the number with the highest probability is 20. This is similar to `dbinom` which calculates the probability of having `x` successes in `size` trails with the provided `probability`. This may be less useful than the CDF, where can calculate the probability of this number of events or fewer, or at least this number of events with calculating 1 - `ppois` or 1 - `pbinom`.

```{r}
dbinvals <- sapply(1:20, dbinom, size=20, p=0.5)
plot(dbinvals)
```

This is subtly different from a continuous distribution such as the Weibull, where the `dweibull` gives the probability of an event in the next time instant, this isn't that useful by itself. In survival analysis it is used to calculate the hazard function as h(t) = f(t) / S(t). Also in a continuous distribution x can take on floating values, it is a continuous random variable.

# `ppois`

This provides the cdf of the poisson distribution, i.e. the probability that there will be `q` or fewer events in one unit of time with the rate `lambda`.

```{r}
pvals <- sapply(1:30, ppois, lambda=20)
plot(pvals)
```

This is similar to `pbinom` which gives the probability of `q` or fewer events in `size` trials with the given probability.

```{r}
pbinvals <- sapply(1:20, pbinom, size=20, p=0.5)
plot(pbinvals)
```

This is probably more useful than `dbinom`, as it provides the probability of at least having `q` events (1 - `ppois`) or having this number of events or fewer (`ppois`).

In a continuous distribution, this is the probability of having received an event by quantile `q`, and is thus typically far more useful than the instantenous probability from the pdf, while in a discrete distribution the mass function is more useful than its continuous counterpart, but overall perhaps not as useful as the cdf. Also the input quantile `q` can take on continuous values, it isn't limited to whole numbers.

# `rpois`

This function draws a random number of events from the poisson cdf, with parameter `lambda`. `n` provides the number of draws to make.

```{r}
rvals <- rpois(1000, lambda=20)
hist(rvals)
```

Likewise, `rbinom` draws from the binomial distribution with parameters `size` and `p`.

```{r}
rbinvals <- rbinom(1000, size=20, p=0.5)
hist(rbinvals)
```

In a continuous distribution this returns random draws from the cdf, although since the cdf is continuous the resulting values are continuous too. In survival analysis this is used to draw from the distribution of event times.

